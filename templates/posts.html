{% extends 'flatpages/default.html' %}

{% load custom_filters %}
{% load cache %}

{% block title %}
    Posts
{% endblock %}

{% block content %}
   <h1>All news we have today:</h1>
   {{ posts|length }}

   <h3>{{ time_in|date:'M d Y' }}</h3>
   <hr>
   {% cache 60 posts_all %}
       {% if posts %}
           <table>
               <tr>
                   <td>Title</td>
                   <td>Publication date</td>
                   <td>Content</td>
                   <td>Type</td>
                   <td>Category</td>
               </tr>

               {% for post in posts %}
               <tr>
                   <td>{{ post.title|censor }}</td>
                   <td>{{ post.time_in|date:'d M Y' }}</td>
                   <td>{{ post.text_post|censor|truncatewords:20 }}</td>
                   <td>{{ post.get_type_display }}</td>
                   <td>
                       {% for category in post.connection_categ.all %}
                            <a href="{% url 'category_list' category.id %}">{{ category }}</a>
                       {% endfor %}
                   </td>
               </tr>
               {% endfor %}
           </table>
       {% else %}
           <h2>We don't have any news, sorry!</h2>
       {% endif %}
   {% endcache %}

{% endblock %}